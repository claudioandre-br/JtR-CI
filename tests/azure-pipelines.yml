######################################################################
# Copyright (c) 2019 Claudio Andr√© <claudioandre.br at gmail.com>
#
# This program comes with ABSOLUTELY NO WARRANTY; express or implied.
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, as expressed in version 2, seen at
# http://www.gnu.org/licenses/gpl-2.0.html
######################################################################
jobs:
- job: zzuf_fuzz
  container:
    image: 'claudioandre/john:ubuntu.opencl_J558.3'

  variables:
    TARGET_ARCH: "NIX"
    EXTRA: "ZZUF_FUZZ"
    BUILD_OPTS: "--enable-fuzz"

  steps:
    - template: .azure/linux-system-info.yml
    - template: .azure/linux-build-and-test-steps.yml

################################################################################
#                             LIST OF KNOWN ISSUES
#
# Fedora can't run afl
# - it has a buggy dependency on a clang version that is not installable.
#
# The "zzuf-fuzz:" fails on Fedora 30 and Ubuntu 18.04 with:
#   zzuf[s=4,r=0.004]: signal 9 (memory exceeded?)
#   Exited with code 1
#
# I also tested it using a machine with 7GB of total memory with no luck.
################################################################################
